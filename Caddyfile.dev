# Caddy configuration for local development
# Run with: caddy run --config Caddyfile.dev
{
	# Development mode - no HTTPS, local addresses
	auto_https off
	admin off
}

# Local development domain (explicit HTTP)
http://localhost:8080 {
	# Backend API routes
	handle /api/* {
		reverse_proxy localhost:3000 {
			header_up Host {host}
			header_up X-Real-IP {remote_host}
		}
	}

	# API documentation
	handle /docs* {
		reverse_proxy localhost:3000
	}

	# Frontend (Next.js) - everything else
	handle {
		reverse_proxy localhost:3001 {
			header_up Host {host}
			header_up X-Real-IP {remote_host}
		}
	}

	# Logging for development - JSON format (parseable and complete)
	log {
		output stdout
		format json
		level INFO
	}
}
